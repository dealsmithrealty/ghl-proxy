worker_processes 1;

events { worker_connections 1024; }

http {
  client_max_body_size 50m;

  server {
    listen ${PORT:-8080};
    server_name jeff.dealsmithrealty.com;

    location / {
      proxy_pass https://jeff.dsragent2025.net;
      proxy_set_header Host jeff.dsragent2025.net;
      proxy_set_header X-Forwarded-Host $host;
      proxy_set_header X-Forwarded-Proto https;

      proxy_redirect https://jeff.dsragent2025.net/ https://$host/;

      proxy_cookie_domain jeff.dsragent2025.net dealsmithrealty.com;
      proxy_cookie_flags ~* SameSite=None secure;

      sub_filter_once off;
      sub_filter "https://jeff.dsragent2025.net" "https://$host";
      sub_filter "http://jeff.dsragent2025.net" "https://$host";
      sub_filter_types text/html text/css application/javascript;

      proxy_hide_header Content-Security-Policy;
      proxy_hide_header Strict-Transport-Security;
      proxy_hide_header X-Frame-Options;
    }
  }
}
